
<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=XeFrQYFhgsqs3WzdHCV0WvS4NyZmWlRZ"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>商家服务数量分布热力图</title>
    <style type="text/css">
		ul,li{list-style: none;margin:0;padding:0;float:left;}
		html{height:100%}
		body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
		#container{height:500px;width:100%;}
		#r-result{width:100%;}
    </style>	
</head>
<body>
	<div id="container"></div>
	<div id="r-result">
		<input type="button"  onclick="openHeatmap();" value="显示热力图"/><input type="button"  onclick="closeHeatmap();" value="关闭热力图"/>
        "最大值为 "2069
	</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例

    var point = new BMap.Point(116.3822415,39.922771499999996);
    map.centerAndZoom(point, 11);             // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放
  
    var points =[{"lng":116.225100009,"lat":39.8276543858,"count":151},{"lng":116.225100009,"lat":39.8414931573,"count":165},{"lng":116.225100009,"lat":39.8553319289,"count":165},{"lng":116.225100009,"lat":39.8691707004,"count":235},{"lng":116.225100009,"lat":39.883009472,"count":296},{"lng":116.225100009,"lat":39.8968482436,"count":480},{"lng":116.225100009,"lat":39.9106870151,"count":598},{"lng":116.225100009,"lat":39.9245257867,"count":452},{"lng":116.225100009,"lat":39.9383645582,"count":472},{"lng":116.225100009,"lat":39.9522033298,"count":319},{"lng":116.225100009,"lat":39.9660421013,"count":304},{"lng":116.225100009,"lat":39.9798808729,"count":219},{"lng":116.225100009,"lat":39.9937196445,"count":179},{"lng":116.225100009,"lat":40.007558416,"count":160},{"lng":116.225100009,"lat":40.0213971876,"count":148},{"lng":116.243118027,"lat":39.8276543858,"count":159},{"lng":116.243118027,"lat":39.8414931573,"count":220},{"lng":116.243118027,"lat":39.8553319289,"count":276},{"lng":116.243118027,"lat":39.8691707004,"count":349},{"lng":116.243118027,"lat":39.883009472,"count":456},{"lng":116.243118027,"lat":39.8968482436,"count":630},{"lng":116.243118027,"lat":39.9106870151,"count":660},{"lng":116.243118027,"lat":39.9245257867,"count":611},{"lng":116.243118027,"lat":39.9383645582,"count":461},{"lng":116.243118027,"lat":39.9522033298,"count":443},{"lng":116.243118027,"lat":39.9660421013,"count":360},{"lng":116.243118027,"lat":39.9798808729,"count":350},{"lng":116.243118027,"lat":39.9937196445,"count":309},{"lng":116.243118027,"lat":40.007558416,"count":208},{"lng":116.243118027,"lat":40.0213971876,"count":178},{"lng":116.261136045,"lat":39.8276543858,"count":200},{"lng":116.261136045,"lat":39.8414931573,"count":309},{"lng":116.261136045,"lat":39.8553319289,"count":330},{"lng":116.261136045,"lat":39.8691707004,"count":472},{"lng":116.261136045,"lat":39.883009472,"count":513},{"lng":116.261136045,"lat":39.8968482436,"count":668},{"lng":116.261136045,"lat":39.9106870151,"count":700},{"lng":116.261136045,"lat":39.9245257867,"count":641},{"lng":116.261136045,"lat":39.9383645582,"count":568},{"lng":116.261136045,"lat":39.9522033298,"count":516},{"lng":116.261136045,"lat":39.9660421013,"count":408},{"lng":116.261136045,"lat":39.9798808729,"count":393},{"lng":116.261136045,"lat":39.9937196445,"count":332},{"lng":116.261136045,"lat":40.007558416,"count":282},{"lng":116.261136045,"lat":40.0213971876,"count":214},{"lng":116.279154063,"lat":39.8276543858,"count":446},{"lng":116.279154063,"lat":39.8414931573,"count":355},{"lng":116.279154063,"lat":39.8553319289,"count":504},{"lng":116.279154063,"lat":39.8691707004,"count":515},{"lng":116.279154063,"lat":39.883009472,"count":688},{"lng":116.279154063,"lat":39.8968482436,"count":820},{"lng":116.279154063,"lat":39.9106870151,"count":931},{"lng":116.279154063,"lat":39.9245257867,"count":975},{"lng":116.279154063,"lat":39.9383645582,"count":771},{"lng":116.279154063,"lat":39.9522033298,"count":777},{"lng":116.279154063,"lat":39.9660421013,"count":624},{"lng":116.279154063,"lat":39.9798808729,"count":499},{"lng":116.279154063,"lat":39.9937196445,"count":358},{"lng":116.279154063,"lat":40.007558416,"count":359},{"lng":116.279154063,"lat":40.0213971876,"count":376},{"lng":116.297172081,"lat":39.8276543858,"count":699},{"lng":116.297172081,"lat":39.8414931573,"count":801},{"lng":116.297172081,"lat":39.8553319289,"count":712},{"lng":116.297172081,"lat":39.8691707004,"count":685},{"lng":116.297172081,"lat":39.883009472,"count":806},{"lng":116.297172081,"lat":39.8968482436,"count":808},{"lng":116.297172081,"lat":39.9106870151,"count":872},{"lng":116.297172081,"lat":39.9245257867,"count":921},{"lng":116.297172081,"lat":39.9383645582,"count":857},{"lng":116.297172081,"lat":39.9522033298,"count":860},{"lng":116.297172081,"lat":39.9660421013,"count":809},{"lng":116.297172081,"lat":39.9798808729,"count":977},{"lng":116.297172081,"lat":39.9937196445,"count":542},{"lng":116.297172081,"lat":40.007558416,"count":478},{"lng":116.297172081,"lat":40.0213971876,"count":503},{"lng":116.315190099,"lat":39.8276543858,"count":781},{"lng":116.315190099,"lat":39.8414931573,"count":726},{"lng":116.315190099,"lat":39.8553319289,"count":720},{"lng":116.315190099,"lat":39.8691707004,"count":750},{"lng":116.315190099,"lat":39.883009472,"count":985},{"lng":116.315190099,"lat":39.8968482436,"count":1054},{"lng":116.315190099,"lat":39.9106870151,"count":1070},{"lng":116.315190099,"lat":39.9245257867,"count":978},{"lng":116.315190099,"lat":39.9383645582,"count":910},{"lng":116.315190099,"lat":39.9522033298,"count":1139},{"lng":116.315190099,"lat":39.9660421013,"count":930},{"lng":116.315190099,"lat":39.9798808729,"count":1324},{"lng":116.315190099,"lat":39.9937196445,"count":1118},{"lng":116.315190099,"lat":40.007558416,"count":557},{"lng":116.315190099,"lat":40.0213971876,"count":568},{"lng":116.333208117,"lat":39.8276543858,"count":584},{"lng":116.333208117,"lat":39.8414931573,"count":718},{"lng":116.333208117,"lat":39.8553319289,"count":429},{"lng":116.333208117,"lat":39.8691707004,"count":805},{"lng":116.333208117,"lat":39.883009472,"count":857},{"lng":116.333208117,"lat":39.8968482436,"count":938},{"lng":116.333208117,"lat":39.9106870151,"count":962},{"lng":116.333208117,"lat":39.9245257867,"count":660},{"lng":116.333208117,"lat":39.9383645582,"count":975},{"lng":116.333208117,"lat":39.9522033298,"count":1058},{"lng":116.333208117,"lat":39.9660421013,"count":1040},{"lng":116.333208117,"lat":39.9798808729,"count":1455},{"lng":116.333208117,"lat":39.9937196445,"count":1386},{"lng":116.333208117,"lat":40.007558416,"count":833},{"lng":116.333208117,"lat":40.0213971876,"count":677},{"lng":116.351226135,"lat":39.8276543858,"count":549},{"lng":116.351226135,"lat":39.8414931573,"count":751},{"lng":116.351226135,"lat":39.8553319289,"count":737},{"lng":116.351226135,"lat":39.8691707004,"count":893},{"lng":116.351226135,"lat":39.883009472,"count":940},{"lng":116.351226135,"lat":39.8968482436,"count":1123},{"lng":116.351226135,"lat":39.9106870151,"count":1209},{"lng":116.351226135,"lat":39.9245257867,"count":1004},{"lng":116.351226135,"lat":39.9383645582,"count":1254},{"lng":116.351226135,"lat":39.9522033298,"count":1335},{"lng":116.351226135,"lat":39.9660421013,"count":1251},{"lng":116.351226135,"lat":39.9798808729,"count":1470},{"lng":116.351226135,"lat":39.9937196445,"count":1003},{"lng":116.351226135,"lat":40.007558416,"count":878},{"lng":116.351226135,"lat":40.0213971876,"count":716},{"lng":116.369244153,"lat":39.8276543858,"count":512},{"lng":116.369244153,"lat":39.8414931573,"count":765},{"lng":116.369244153,"lat":39.8553319289,"count":782},{"lng":116.369244153,"lat":39.8691707004,"count":860},{"lng":116.369244153,"lat":39.883009472,"count":911},{"lng":116.369244153,"lat":39.8968482436,"count":1154},{"lng":116.369244153,"lat":39.9106870151,"count":1260},{"lng":116.369244153,"lat":39.9245257867,"count":1200},{"lng":116.369244153,"lat":39.9383645582,"count":1322},{"lng":116.369244153,"lat":39.9522033298,"count":1135},{"lng":116.369244153,"lat":39.9660421013,"count":1128},{"lng":116.369244153,"lat":39.9798808729,"count":1080},{"lng":116.369244153,"lat":39.9937196445,"count":989},{"lng":116.369244153,"lat":40.007558416,"count":938},{"lng":116.369244153,"lat":40.0213971876,"count":708},{"lng":116.387262171,"lat":39.8276543858,"count":449},{"lng":116.387262171,"lat":39.8414931573,"count":876},{"lng":116.387262171,"lat":39.8553319289,"count":952},{"lng":116.387262171,"lat":39.8691707004,"count":931},{"lng":116.387262171,"lat":39.883009472,"count":728},{"lng":116.387262171,"lat":39.8968482436,"count":1115},{"lng":116.387262171,"lat":39.9106870151,"count":1170},{"lng":116.387262171,"lat":39.9245257867,"count":936},{"lng":116.387262171,"lat":39.9383645582,"count":1101},{"lng":116.387262171,"lat":39.9522033298,"count":1133},{"lng":116.387262171,"lat":39.9660421013,"count":1124},{"lng":116.387262171,"lat":39.9798808729,"count":1030},{"lng":116.387262171,"lat":39.9937196445,"count":978},{"lng":116.387262171,"lat":40.007558416,"count":881},{"lng":116.387262171,"lat":40.0213971876,"count":597},{"lng":116.405280189,"lat":39.8276543858,"count":461},{"lng":116.405280189,"lat":39.8414931573,"count":770},{"lng":116.405280189,"lat":39.8553319289,"count":877},{"lng":116.405280189,"lat":39.8691707004,"count":889},{"lng":116.405280189,"lat":39.883009472,"count":736},{"lng":116.405280189,"lat":39.8968482436,"count":1013},{"lng":116.405280189,"lat":39.9106870151,"count":788},{"lng":116.405280189,"lat":39.9245257867,"count":551},{"lng":116.405280189,"lat":39.9383645582,"count":1362},{"lng":116.405280189,"lat":39.9522033298,"count":1372},{"lng":116.405280189,"lat":39.9660421013,"count":1069},{"lng":116.405280189,"lat":39.9798808729,"count":1020},{"lng":116.405280189,"lat":39.9937196445,"count":1095},{"lng":116.405280189,"lat":40.007558416,"count":933},{"lng":116.405280189,"lat":40.0213971876,"count":566},{"lng":116.423298207,"lat":39.8276543858,"count":544},{"lng":116.423298207,"lat":39.8414931573,"count":705},{"lng":116.423298207,"lat":39.8553319289,"count":890},{"lng":116.423298207,"lat":39.8691707004,"count":986},{"lng":116.423298207,"lat":39.883009472,"count":810},{"lng":116.423298207,"lat":39.8968482436,"count":1107},{"lng":116.423298207,"lat":39.9106870151,"count":1325},{"lng":116.423298207,"lat":39.9245257867,"count":1294},{"lng":116.423298207,"lat":39.9383645582,"count":1302},{"lng":116.423298207,"lat":39.9522033298,"count":1280},{"lng":116.423298207,"lat":39.9660421013,"count":1237},{"lng":116.423298207,"lat":39.9798808729,"count":1032},{"lng":116.423298207,"lat":39.9937196445,"count":1025},{"lng":116.423298207,"lat":40.007558416,"count":843},{"lng":116.423298207,"lat":40.0213971876,"count":764},{"lng":116.441316225,"lat":39.8276543858,"count":557},{"lng":116.441316225,"lat":39.8414931573,"count":730},{"lng":116.441316225,"lat":39.8553319289,"count":809},{"lng":116.441316225,"lat":39.8691707004,"count":981},{"lng":116.441316225,"lat":39.883009472,"count":859},{"lng":116.441316225,"lat":39.8968482436,"count":1068},{"lng":116.441316225,"lat":39.9106870151,"count":1351},{"lng":116.441316225,"lat":39.9245257867,"count":1792},{"lng":116.441316225,"lat":39.9383645582,"count":2069},{"lng":116.441316225,"lat":39.9522033298,"count":1550},{"lng":116.441316225,"lat":39.9660421013,"count":1128},{"lng":116.441316225,"lat":39.9798808729,"count":1044},{"lng":116.441316225,"lat":39.9937196445,"count":1162},{"lng":116.441316225,"lat":40.007558416,"count":780},{"lng":116.441316225,"lat":40.0213971876,"count":715},{"lng":116.459334243,"lat":39.8276543858,"count":545},{"lng":116.459334243,"lat":39.8414931573,"count":654},{"lng":116.459334243,"lat":39.8553319289,"count":771},{"lng":116.459334243,"lat":39.8691707004,"count":979},{"lng":116.459334243,"lat":39.883009472,"count":1319},{"lng":116.459334243,"lat":39.8968482436,"count":1439},{"lng":116.459334243,"lat":39.9106870151,"count":1705},{"lng":116.459334243,"lat":39.9245257867,"count":1963},{"lng":116.459334243,"lat":39.9383645582,"count":1753},{"lng":116.459334243,"lat":39.9522033298,"count":759},{"lng":116.459334243,"lat":39.9660421013,"count":1082},{"lng":116.459334243,"lat":39.9798808729,"count":1005},{"lng":116.459334243,"lat":39.9937196445,"count":1294},{"lng":116.459334243,"lat":40.007558416,"count":1125},{"lng":116.459334243,"lat":40.0213971876,"count":578},{"lng":116.477352261,"lat":39.8276543858,"count":543},{"lng":116.477352261,"lat":39.8414931573,"count":527},{"lng":116.477352261,"lat":39.8553319289,"count":662},{"lng":116.477352261,"lat":39.8691707004,"count":819},{"lng":116.477352261,"lat":39.883009472,"count":1176},{"lng":116.477352261,"lat":39.8968482436,"count":1198},{"lng":116.477352261,"lat":39.9106870151,"count":1568},{"lng":116.477352261,"lat":39.9245257867,"count":1593},{"lng":116.477352261,"lat":39.9383645582,"count":1532},{"lng":116.477352261,"lat":39.9522033298,"count":1302},{"lng":116.477352261,"lat":39.9660421013,"count":1007},{"lng":116.477352261,"lat":39.9798808729,"count":1621},{"lng":116.477352261,"lat":39.9937196445,"count":1297},{"lng":116.477352261,"lat":40.007558416,"count":1111},{"lng":116.477352261,"lat":40.0213971876,"count":763},{"lng":116.495370279,"lat":39.8276543858,"count":516},{"lng":116.495370279,"lat":39.8414931573,"count":469},{"lng":116.495370279,"lat":39.8553319289,"count":589},{"lng":116.495370279,"lat":39.8691707004,"count":671},{"lng":116.495370279,"lat":39.883009472,"count":1135},{"lng":116.495370279,"lat":39.8968482436,"count":1178},{"lng":116.495370279,"lat":39.9106870151,"count":1378},{"lng":116.495370279,"lat":39.9245257867,"count":1407},{"lng":116.495370279,"lat":39.9383645582,"count":1266},{"lng":116.495370279,"lat":39.9522033298,"count":746},{"lng":116.495370279,"lat":39.9660421013,"count":926},{"lng":116.495370279,"lat":39.9798808729,"count":1000},{"lng":116.495370279,"lat":39.9937196445,"count":1101},{"lng":116.495370279,"lat":40.007558416,"count":1208},{"lng":116.495370279,"lat":40.0213971876,"count":425},{"lng":116.513388297,"lat":39.8276543858,"count":591},{"lng":116.513388297,"lat":39.8414931573,"count":479},{"lng":116.513388297,"lat":39.8553319289,"count":534},{"lng":116.513388297,"lat":39.8691707004,"count":560},{"lng":116.513388297,"lat":39.883009472,"count":603},{"lng":116.513388297,"lat":39.8968482436,"count":638},{"lng":116.513388297,"lat":39.9106870151,"count":993},{"lng":116.513388297,"lat":39.9245257867,"count":1139},{"lng":116.513388297,"lat":39.9383645582,"count":1095},{"lng":116.513388297,"lat":39.9522033298,"count":856},{"lng":116.513388297,"lat":39.9660421013,"count":821},{"lng":116.513388297,"lat":39.9798808729,"count":750},{"lng":116.513388297,"lat":39.9937196445,"count":719},{"lng":116.513388297,"lat":40.007558416,"count":484},{"lng":116.513388297,"lat":40.0213971876,"count":351},{"lng":116.531406315,"lat":39.8276543858,"count":603},{"lng":116.531406315,"lat":39.8414931573,"count":415},{"lng":116.531406315,"lat":39.8553319289,"count":507},{"lng":116.531406315,"lat":39.8691707004,"count":528},{"lng":116.531406315,"lat":39.883009472,"count":508},{"lng":116.531406315,"lat":39.8968482436,"count":542},{"lng":116.531406315,"lat":39.9106870151,"count":843},{"lng":116.531406315,"lat":39.9245257867,"count":1060},{"lng":116.531406315,"lat":39.9383645582,"count":942},{"lng":116.531406315,"lat":39.9522033298,"count":772},{"lng":116.531406315,"lat":39.9660421013,"count":625},{"lng":116.531406315,"lat":39.9798808729,"count":394},{"lng":116.531406315,"lat":39.9937196445,"count":409},{"lng":116.531406315,"lat":40.007558416,"count":368},{"lng":116.531406315,"lat":40.0213971876,"count":340},];
   
    if(!isSupportCanvas()){
    	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
	//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
	//参数说明如下:
	/* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小   
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *	{
			.2:'rgb(0, 255, 255)',
			.5:'rgb(0, 110, 255)',
			.8:'rgb(100, 0, 255)'
		}
		其中 key 表示插值的位置, 0~1. 
		    value 为颜色值. 
     */
	heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":20});
	map.addOverlay(heatmapOverlay);
	heatmapOverlay.setDataSet({data:points,max:2069});
	//是否显示热力图
    function openHeatmap(){
        heatmapOverlay.show();
    }
	function closeHeatmap(){
        heatmapOverlay.hide();
    }
	closeHeatmap();
    function setGradient(){
     	/*格式如下所示:
		{
	  		0:'rgb(102, 255, 0)',
	 	 	.5:'rgb(255, 170, 0)',
		  	1:'rgb(255, 0, 0)'
		}*/
     	var gradient = {};
     	var colors = document.querySelectorAll("input[type='color']");
     	colors = [].slice.call(colors,0);
     	colors.forEach(function(ele){
			gradient[ele.getAttribute("data-key")] = ele.value; 
     	});
        heatmapOverlay.setOptions({"gradient":gradient});
    }
	//判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>
